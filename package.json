{
  "name": "archipilot",
  "displayName": "Archipilot – Enterprise Architecture Copilot",
  "description": "TOGAF-aligned Enterprise Architecture assistant that uses Obsidian vaults as structured context, powered by GitHub Copilot.",
  "version": "0.14.0",
  "publisher": "enzomar",
  "icon": "media/icon.png",
  "author": {
    "name": "Vincenzo Marafioti",
    "url": "https://github.com/enzomar"
  },
  "license": "MIT",
  "repository": {
    "type": "git",
    "url": "https://github.com/enzomar/archipilot.git"
  },
  "bugs": {
    "url": "https://github.com/enzomar/archipilot/issues"
  },
  "homepage": "https://enzomar.github.io/archipilot/",
  "keywords": [
    "togaf",
    "enterprise-architecture",
    "obsidian",
    "copilot",
    "architecture-decision-records",
    "adm",
    "vscode-extension"
  ],
  "engines": {
    "vscode": "^1.93.0"
  },
  "categories": [
    "AI",
    "Chat"
  ],
  "activationEvents": [],
  "main": "./out/extension.js",
  "contributes": {
    "viewsContainers": {
      "activitybar": [
        {
          "id": "archipilot-sidebar",
          "title": "archipilot",
          "icon": "media/sidebar-icon.svg"
        }
      ]
    },
    "views": {
      "archipilot-sidebar": [
        {
          "id": "archipilot.vaultExplorer",
          "name": "Vault Explorer"
        },
        {
          "id": "archipilot.quickActions",
          "name": "Quick Actions"
        },
        {
          "id": "archipilot.architectureHealth",
          "name": "Architecture Health"
        }
      ]
    },
    "viewsWelcome": [
      {
        "view": "archipilot.vaultExplorer",
        "contents": "No architecture vault detected.\n[Create New Vault](command:archipilot.newVault)\n[Scan Workspace](command:archipilot.scanWorkspace)\n[Switch Vault](command:archipilot.switchVault)"
      }
    ],
    "chatParticipants": [
      {
        "id": "archipilot.architect",
        "fullName": "archipilot",
        "name": "architect",
        "description": "Enterprise Architecture Copilot – TOGAF-aligned assistant for Obsidian architecture vaults",
        "isSticky": true,
        "commands": [
          {
            "name": "analyze",
            "description": "Analyze architecture impact without modifying files"
          },
          {
            "name": "decide",
            "description": "Help resolve an architecture decision"
          },
          {
            "name": "update",
            "description": "Update vault documents (applies edits)"
          },
          {
            "name": "status",
            "description": "Show vault overview and decision status"
          },
          {
            "name": "switch",
            "description": "Switch active vault folder"
          },
          {
            "name": "c4",
            "description": "Generate a C4 model diagram (Context, Container, Component, Code)"
          },
          {
            "name": "sizing",
            "description": "Create or update a sizing catalogue (infrastructure, capacity, cost)"
          },
          {
            "name": "timeline",
            "description": "Generate a delivery timeline / Gantt from the roadmap"
          },
          {
            "name": "new",
            "description": "Create a new empty architecture vault / project"
          },
          {
            "name": "archimate",
            "description": "Export vault to ArchiMate Open Exchange Format 3.2 (XML)"
          },
          {
            "name": "drawio",
            "description": "Export vault to Draw.io diagrams (As-Is, Target, Migration with color-coded changes)"
          },
          {
            "name": "todo",
            "description": "List next TOGAF action items: open decisions, risks, questions, work packages, and more"
          },
          {
            "name": "adr",
            "description": "Record a new Architecture Decision — e.g. /adr Use PostgreSQL for transactional data"
          },
          {
            "name": "diagram",
            "description": "Generate a Mermaid context diagram from the active file's [[WikiLinks]]"
          },
          {
            "name": "graph",
            "description": "Visualize the entire vault as a full dependency graph (Mermaid flowchart)"
          },
          {
            "name": "impact",
            "description": "Show the cross-vault impact chain for a TOGAF ID, e.g. /impact AD-02 or /impact R-05"
          },
          {
            "name": "review",
            "description": "Automated architecture review — assess quality, completeness, and TOGAF compliance (alias for /audit)"
          },
          {
            "name": "gate",
            "description": "Phase gate checklist — evaluate whether a TOGAF ADM phase is ready to proceed (alias for /audit)"
          },
          {
            "name": "audit",
            "description": "Unified vault health check — combines status, review, and gate assessment. Use --quick for a summary or --full for comprehensive audit."
          },
          {
            "name": "scan",
            "description": "Generate or enrich a TOGAF vault by scanning workspace source code. Use --append to add to an existing vault."
          }
        ]
      }
    ],
    "commands": [
      {
        "command": "archipilot.switchVault",
        "title": "archipilot: Switch Architecture Vault"
      },
      {
        "command": "archipilot.showStatus",
        "title": "archipilot: Show Vault Status"
      },
      {
        "command": "archipilot.applyCommand",
        "title": "archipilot: Apply Architecture Command"
      },
      {
        "command": "archipilot.newVault",
        "title": "archipilot: Create New Architecture Vault"
      },
      {
        "command": "archipilot.scanWorkspace",
        "title": "archipilot: Scan Workspace & Generate Vault",
        "icon": "$(search)"
      },
      {
        "command": "archipilot.recordDecision",
        "title": "archipilot: Record Decision (ADR)"
      },
      {
        "command": "archipilot.generateContextDiagram",
        "title": "archipilot: Generate Context Diagram"
      },
      {
        "command": "archipilot.showGraph",
        "title": "archipilot: Visualize Vault Graph"
      },
      {
        "command": "archipilot.exportArchimate",
        "title": "archipilot: Export Vault to ArchiMate (XML)"
      },
      {
        "command": "archipilot.exportDrawio",
        "title": "archipilot: Export Vault to Draw.io (As-Is / Target / Migration)"
      },
      {
        "command": "archipilot.refreshSidebar",
        "title": "archipilot: Refresh Sidebar",
        "icon": "$(refresh)"
      },
      {
        "command": "archipilot.openDocument",
        "title": "archipilot: Open Document"
      },
      {
        "command": "archipilot.askCopilot",
        "title": "archipilot: Ask Copilot about this",
        "icon": "$(comment-discussion)"
      },
      {
        "command": "archipilot.openSplitPreview",
        "title": "archipilot: Open in Split Preview",
        "icon": "$(open-preview)"
      },
      {
        "command": "archipilot.filterVaultExplorer",
        "title": "archipilot: Search / Filter Vault Files",
        "icon": "$(search)"
      }
    ],
    "menus": {
      "view/title": [
        {
          "command": "archipilot.refreshSidebar",
          "when": "view =~ /^archipilot\\./",
          "group": "navigation"
        },
        {
          "command": "archipilot.filterVaultExplorer",
          "when": "view == archipilot.vaultExplorer",
          "group": "navigation"
        }
      ],
      "view/item/context": [
        {
          "command": "archipilot.openDocument",
          "when": "viewItem == vaultFile",
          "group": "inline"
        },
        {
          "command": "archipilot.askCopilot",
          "when": "viewItem == vaultFile",
          "group": "inline"
        },
        {
          "command": "archipilot.openSplitPreview",
          "when": "viewItem == vaultFile",
          "group": "inline"
        }
      ]
    },
    "configuration": {
      "title": "archipilot",
      "properties": {
        "archipilot.vaultPath": {
          "type": "string",
          "default": "",
          "description": "Path to the active Obsidian architecture vault folder. Leave empty to auto-detect from workspace."
        },
        "archipilot.projectsRoot": {
          "type": "string",
          "default": "architectures",
          "description": "Folder name (relative to workspace root) where architecture projects are created and discovered. The /new command creates vaults inside this folder."
        },
        "archipilot.hiddenQuickActions": {
          "type": "array",
          "default": [],
          "items": {
            "type": "string"
          },
          "description": "List of Quick Action labels or command shortcuts to hide from the sidebar (e.g. [\"Sizing Catalogue\", \"/sizing\"]). Use the label text or the /command shortcut shown in the Quick Actions panel."
        },
        "archipilot.contextScoping": {
          "type": "boolean",
          "default": true,
          "description": "When enabled, each command loads only the vault files relevant to its TOGAF phase (reduces token usage, improves response quality). Disable to always send the full vault."
        }
      }
    },
    "walkthroughs": [
      {
        "id": "archipilot.gettingStarted",
        "title": "Get Started with archipilot",
        "description": "Set up your TOGAF-aligned architecture vault and start working with your Enterprise Architecture Copilot.",
        "steps": [
          {
            "id": "scanOrCreate",
            "title": "1. Scan Workspace or Create Vault",
            "description": "**Option A — From existing code:** Type **@architect /scan** to auto-generate a TOGAF vault from your source code.\n\n**Option B — From scratch:** Type **@architect /new MyProject** to scaffold an empty vault.\n\n[Scan Workspace](command:archipilot.scanWorkspace)\n[Create Empty Vault](command:archipilot.newVault)",
            "media": {
              "markdown": "media/walkthrough-create.md"
            }
          },
          {
            "id": "auditVault",
            "title": "2. Audit Your Vault",
            "description": "Run **@architect /audit** for a comprehensive health check — combines status dashboard, quality review, and gate assessment in one command.\n\nUse **@architect /audit --quick** for a summary.\n\n[Show status](command:archipilot.showStatus)",
            "media": {
              "markdown": "media/walkthrough-status.md"
            }
          },
          {
            "id": "analyzeArchitecture",
            "title": "3. Analyze Architecture Impact",
            "description": "Ask **@architect /analyze** a question like *\"What is the impact of migrating to microservices?\"* to get a grounded analysis from your vault.",
            "media": {
              "markdown": "media/walkthrough-analyze.md"
            }
          },
          {
            "id": "decideAndRecord",
            "title": "4. Make Decisions",
            "description": "Use **@architect /decide** to analyze a decision. archipilot presents options first, then records the decision after you confirm.\n\nDecisions are tracked in the ADR Decision Log.",
            "media": {
              "markdown": "media/walkthrough-update.md"
            }
          },
          {
            "id": "updateVault",
            "title": "5. Update Your Vault",
            "description": "Use **@architect /update** to add decisions, update sections, or modify metadata. archipilot shows a diff preview before applying any changes.\n\nUse **--dry-run** to preview without applying.",
            "media": {
              "markdown": "media/walkthrough-update.md"
            }
          },
          {
            "id": "generateDiagrams",
            "title": "6. Generate Diagrams & Exports",
            "description": "Generate architecture diagrams and exports:\n\n- **@architect /c4** — C4 model diagrams\n- **@architect /timeline** — Gantt timeline\n- **@architect /archimate** — ArchiMate XML export\n- **@architect /drawio** — Draw.io diagrams\n- **@architect /diagram** — Context diagram from WikiLinks",
            "media": {
              "markdown": "media/walkthrough-analyze.md"
            }
          }
        ]
      }
    ]
  },
  "scripts": {
    "vscode:prepublish": "npm run package",
    "compile": "node esbuild.mjs",
    "watch": "node esbuild.mjs --watch",
    "package": "node esbuild.mjs --production",
    "typecheck": "tsc -p ./ --noEmit",
    "lint": "eslint src/",
    "test": "node --import tsx --test src/test/*.test.ts",
    "deploy:wiki": "bash scripts/deploy-wiki.sh",
    "deploy:pages": "bash scripts/deploy-gh-pages.sh",
    "generate:obsidian": "npx tsx scripts/generate-obsidian-templates.ts",
    "prepare": "git config core.hooksPath .githooks"
  },
  "devDependencies": {
    "@types/node": "^20.0.0",
    "@types/vscode": "^1.93.0",
    "@typescript-eslint/eslint-plugin": "^8.56.0",
    "@typescript-eslint/parser": "^8.56.0",
    "@vscode/vsce": "^3.7.1",
    "esbuild": "^0.27.3",
    "eslint": "^9.39.2",
    "tsx": "^4.21.0",
    "typescript": "^5.4.0"
  }
}
